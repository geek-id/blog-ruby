!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i)}:e(window.jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color"],wordPasteModal:!0}),e.FE.PLUGINS.wordPaste=function(t){function i(){t.events.on("paste.wordPaste",function(e){return H=e,t.opts.wordPasteModal?n():a(!0),!1})}function r(){var e='<div class="fr-word-paste-modal" style="padding: 20px 20px 10px 20px;">';return e+='<p style="text-align: left;">'+t.language.translate("The pasted content is coming from a Microsoft Word document. Do you want to keep the format or clean it up?")+"</p>",e+='<div style="text-align: right; margin-top: 50px;"><button class="fr-remove-word fr-command">'+t.language.translate("Clean")+'</button> <button class="fr-keep-word fr-command">'+t.language.translate("Keep")+"</button></div>",e+="</div>"}function n(){if(!M){var i='<h4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 74.95 73.23" style="height: 25px; vertical-align: text-bottom; margin-right: 5px; display: inline-block"><defs><style>.a{fill:#2a5699;}.b{fill:#fff;}</style></defs><path class="a" d="M615.15,827.22h5.09V834c9.11.05,18.21-.09,27.32.05a2.93,2.93,0,0,1,3.29,3.25c.14,16.77,0,33.56.09,50.33-.09,1.72.17,3.63-.83,5.15-1.24.89-2.85.78-4.3.84-8.52,0-17,0-25.56,0v6.81h-5.32c-13-2.37-26-4.54-38.94-6.81q0-29.8,0-59.59c13.05-2.28,26.11-4.5,39.17-6.83Z" transform="translate(-575.97 -827.22)"/><path class="b" d="M620.24,836.59h28.1v54.49h-28.1v-6.81h22.14v-3.41H620.24v-4.26h22.14V873.2H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24V846h22.14v-3.41H620.24Zm-26.67,15c1.62-.09,3.24-.16,4.85-.25,1.13,5.75,2.29,11.49,3.52,17.21,1-5.91,2-11.8,3.06-17.7,1.7-.06,3.41-.15,5.1-.26-1.92,8.25-3.61,16.57-5.71,24.77-1.42.74-3.55,0-5.24.09-1.13-5.64-2.45-11.24-3.47-16.9-1,5.5-2.29,10.95-3.43,16.42q-2.45-.13-4.92-.3c-1.41-7.49-3.07-14.93-4.39-22.44l4.38-.18c.88,5.42,1.87,10.82,2.64,16.25,1.2-5.57,2.43-11.14,3.62-16.71Z" transform="translate(-575.97 -827.22)"/></svg> '+t.language.translate("Word Paste Detected")+"</h4>",n=r(),l=t.modals.create(w,i,n),a=l.$body;M=l.$modal,l.$modal.addClass("fr-middle"),t.events.bindClick(a,"button.fr-remove-word",function(){(M.data("instance")||t).wordPaste.clean()}),t.events.bindClick(a,"button.fr-keep-word",function(){(M.data("instance")||t).wordPaste.clean(!0)}),t.events.$on(e(t.o_win),"resize",function(){t.modals.resize(w)})}t.modals.show(w),t.modals.resize(w)}function l(){t.modals.hide(w)}function a(e){e&&(H=H.replace(/^\n*/g,"").replace(/^ /g,""),0===H.indexOf("<colgroup>")&&(H="<table>"+H+"</table>"),H=x(H,t.paste.getRtfClipboard()),H=t.paste.removeEmptyTags(H)),l(),t.paste.clean(H,!0,e)}function s(e){e.parentNode&&e.parentNode.removeChild(e)}function o(e,t){if(t(e))for(var i=e.firstChild;i;){var r=i,n=i.previousSibling;i=i.nextSibling,o(r,t),r.previousSibling||r.nextSibling||r.parentNode||!i||n==i.previousSibling||!i.parentNode?r.previousSibling||r.nextSibling||r.parentNode||!i||i.previousSibling||i.nextSibling||i.parentNode||(n?i=n.nextSibling?n.nextSibling.nextSibling:null:e.firstChild&&(i=e.firstChild.nextSibling)):i=n?n.nextSibling:e.firstChild}}function d(e){return e.nodeType==Node.ELEMENT_NODE&&e.getAttribute("style")&&-1!=e.getAttribute("style").replace(/\n/gi,"").indexOf("mso-list:Ignore")}function f(e){if(!e.getAttribute("style")||!/mso-list:[\s]*l/gi.test(e.getAttribute("style").replace(/\n/gi,"")))return!1;try{var t=e.firstElementChild.firstElementChild,i=t.firstElementChild?t.firstElementChild:null;if(!d(t)&&!d(i))return!1}catch(e){return!1}return!0}function u(e){return e.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1")}function g(e,t){var i=e.cloneNode(!0);if(i.firstElementChild&&"A"==i.firstElementChild.tagName&&(i=i.firstElementChild),s(i.firstElementChild),-1!=["H1","H2","H3","H4","H5","H6"].indexOf(e.tagName)){var r=document.createElement(e.tagName.toLowerCase());r.setAttribute("style",e.getAttribute("style")),r.innerHTML=i.innerHTML,i.innerHTML=r.outerHTML}o(i,function(e){return e.nodeType==Node.ELEMENT_NODE&&N(e,t),!0});var n=i.innerHTML;return n=n.replace(/<!--[\s\S]*?-->/gi,"")}function c(e,t){var i=/[0-9a-zA-Z]./gi,r=!1;e.firstElementChild&&e.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.firstChild&&!(r=r||i.test(e.firstElementChild.firstElementChild.firstChild.data))&&e.firstElementChild.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.firstElementChild.firstChild&&(r=r||i.test(e.firstElementChild.firstElementChild.firstElementChild.firstChild.data));var n=r?"ol":"ul",l=u(e),a="<"+n+"><li>"+g(e,t),o=e.nextElementSibling,d=e.parentNode;for(s(e),e=null;o&&f(o);){var m=o.previousElementSibling,h=u(o);if(h>l)a+=c(o,t).outerHTML;else{if(h<l)break;a+="</li><li>"+g(o,t)}if(l=h,o.previousElementSibling||o.nextElementSibling||o.parentNode){var p=o;o=o.nextElementSibling,s(p),p=null}else o=m?m.nextElementSibling:d.firstElementChild}a+="</li></"+n+">";var v=document.createElement("div");return v.innerHTML=a,v.firstElementChild}function m(e,t){for(var i=document.createElement(t),r=0;r<e.attributes.length;r++){var n=e.attributes[r].name;i.setAttribute(n,e.getAttribute(n))}return i.innerHTML=e.innerHTML,e.parentNode.replaceChild(i,e),i}function h(e){var t=null;if(e.firstElementChild&&(t=e.firstElementChild.tagName,-1!=["SPAN","STRONG","B","S","EM","U","SUB","SUP"].indexOf(t))){if("TD"!=e.tagName)for(var i=e.firstElementChild;i;){if("SPAN"==i.tagName){E(i,e.getAttribute("style"));break}i=i.firstElementChild}}else if("DIV"!=t){var r=e.getAttribute("style"),n=document.createElement("span");r&&(r=b(r),n.setAttribute("style",r)),n.innerHTML=e.innerHTML,e.innerHTML=n.outerHTML}}function p(i,r){t.node.clearAttributes(i);for(var n=i.firstElementChild,l=0,a=!1,o=null;n;){n.firstElementChild&&-1!=n.firstElementChild.tagName.indexOf("W:")&&(n.innerHTML=n.firstElementChild.innerHTML),o=n.getAttribute("width"),o||a||(a=!0),l+=parseInt(o,10),(!n.firstChild||n.firstChild&&n.firstChild.data==e.FE.UNICODE_NBSP)&&(n.firstChild&&s(n.firstChild),n.innerHTML="<br>");for(var d=n.firstElementChild,u=1==n.children.length;d;){if("P"==d.tagName&&!f(d)){var g=null;1==d.children.length&&d.firstElementChild&&"SPAN"==d.firstElementChild.tagName?(g=d.firstElementChild,u||(g=m(g,"div")),u?E(n,d.getAttribute("style")):E(g,d.getAttribute("style")),n.replaceChild(g,d)):(g=m(d,u?"span":"div"),!u&&g.getAttribute("align")&&g.removeAttribute("align")),d=g,u&&v(d)}d=d.nextElementSibling}if(r){var c=n.getAttribute("class");if(c){c=b(c);var p=c.match(/xl[0-9]+/gi);if(p){var A=p[0],T="."+A;r[T]&&E(n,r[T])}}r.td&&E(n,r.td),h(n),C(n)}var y=n.getAttribute("style");y&&(y=b(y))&&";"!=y.slice(-1)&&(y+=";");var N=n.getAttribute("valign");if(!N&&y){var S=y.match(/vertical-align:.+?[; "]{1,1}/gi);S&&(N=S[S.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var x=null;if(y){var M=y.match(/text-align:.+?[; "]{1,1}/gi);M&&(x=M[M.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"==x&&(x=null)}var H=null;if(y){var w=y.match(/background:.+?[; "]{1,1}/gi);w&&(H=w[w.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var L=n.getAttribute("colspan"),O=n.getAttribute("rowspan");t.node.clearAttributes(n),L&&n.setAttribute("colspan",L),O&&n.setAttribute("rowspan",O),N&&(n.style["vertical-align"]=N),x&&(n.style["text-align"]=x),H&&(n.style["background-color"]=H),o&&n.setAttribute("width",o),n=n.nextElementSibling}for(n=i.firstElementChild;n;)o=n.getAttribute("width"),a?n.removeAttribute("width"):n.setAttribute("width",100*parseInt(o,10)/l+"%"),n=n.nextElementSibling}function v(e){var t=e.parentNode,i=e.getAttribute("align");i&&(t&&"TD"==t.tagName?(t.setAttribute("style",t.getAttribute("style")+"text-align:"+i+";"),e.removeAttribute("align")):(e.style["text-align"]=i,e.removeAttribute("align")))}function b(e){return e.replace(/\n|\r|\n\r|&quot;/g,"")}function E(e,t,i){if(t){var r=e.getAttribute("style");r&&";"!=r.slice(-1)&&(r+=";"),t&&";"!=t.slice(-1)&&(t+=";"),t=t.replace(/\n/gi,"");var n=null;n=i?(r||"")+t:t+(r||""),e.setAttribute("style",n)}}function A(e){var t=e.getAttribute("style");if(t){(t=b(t))&&";"!=t.slice(-1)&&(t+=";");var i=t.match(/(^|\S+?):.+?;{1,1}/gi);if(i){for(var r={},n=0;n<i.length;n++){var l=i[n],a=l.split(":");2==a.length&&("text-align"==a[0]&&"SPAN"==e.tagName||(r[a[0]]=a[1]))}var s="";for(var o in r)if(r.hasOwnProperty(o)){if("font-size"==o&&"pt;"==r[o].slice(-3)){var d=null;try{d=parseFloat(r[o].slice(0,-3),10)}catch(e){}d&&(d=Math.round(1.33*d),r[o]=d+"px;")}s+=o+":"+r[o]}s&&e.setAttribute("style",s)}}}function C(e){var t=e.getAttribute("style");if(t){t=b(t);var i=t.match(/(^|;)font-weight:.+?[; "]{1,1}/gi),r=null;if(i&&(r=i[i.length-1].replace(/(^|;)font-weight:(.+?)[; "]{1,1}/gi,"$2")),r&&(r>=700||"bold"==r)){var n=document.createElement("strong");n.innerHTML=e.innerHTML,e.innerHTML=n.outerHTML}if(/(^|;)font-style:(italic|oblique)[; ]/gi.test(t)){var l=document.createElement("em");l.innerHTML=e.innerHTML,e.innerHTML=l.outerHTML}}}function T(e){for(var t=e.match(/[0-9a-f]{2}/gi),i=[],r=0;r<t.length;r++)i.push(String.fromCharCode(parseInt(t[r],16)));var n=i.join("");return btoa(n)}function y(e,t){if(t){var i=e.getAttribute("src");if(i&&-1!=i.indexOf("file://")){var r=e.getAttribute("v:shapes");if(r){if(/^[a-zA-Z]+_/gi.test(r)&&e.previousSibling){var n=e.previousSibling.previousSibling;if(!n)return;var l=n.data.split('o:spid="');if(2!=l.length)return;if(l=l[1].split('"'),l.length<2)return;r=l[0]}var a="hplid"+r.substring(8),s=t.split(a);if(!s||2==s.length){var o=s[1].split("bliptag");if(!(o&&o.length<2)){var d=null;if(-1!=o[0].indexOf("pngblip")?d="image/png":-1!=o[0].indexOf("jpegblip")&&(d="image/jpeg"),d){var f=o[1].split("}");if(!(f&&f.length<2)){var u;if(f.length>2&&-1!=f[0].indexOf("blipuid"))u=f[1].split(" ");else{if((u=f[0].split(" "))&&u.length<2)return;u.shift()}var g=u.join(""),c=T(g),m="data:"+d+";base64,"+c;e.setAttribute("src",m)}}}}}}}}function N(i,r){var n=i.tagName,l=n.toLowerCase();if(i.firstElementChild&&("I"==i.firstElementChild.tagName?m(i.firstElementChild,"em"):"B"==i.firstElementChild.tagName&&m(i.firstElementChild,"strong")),-1!=["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"].indexOf(n))return s(i),!1;"O:P"==n&&"&nbsp;"==i.innerHTML&&(i.innerHTML=e.FE.INVISIBLE_SPACE);var a=-1,o=["META","LINK","XML","ST1:","O:","W:","FONT"];for(a=0;a<o.length;a++)if(-1!=n.indexOf(o[a]))return i.innerHTML?(i.outerHTML=i.innerHTML,s(i),!1):(s(i),!1);if("TD"!=n){var d=i.getAttribute("class");if(r&&d){d=b(d);var f=d.split(" ");for(a=0;a<f.length;a++){var u=f[a],g=[],c="."+u;g.push(c),c=l+c,g.push(c);for(var A=0;A<g.length;A++)r[g[A]]&&E(i,r[g[A]])}}r&&r[l]&&E(i,r[l])}if(-1!=["P","H1","H2","H3","H4","H5","H6","PRE"].indexOf(n)){h(i),C(i);var T=i.getAttribute("style"),y=null;if(T){var N=T.match(/text-align:.+?[; "]{1,1}/gi);N&&(y=N[N.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1"))}y?i.setAttribute("style",y):i.removeAttribute("style")}"P"==n&&v(i),"TR"==n&&p(i,r);var S=i.getAttribute("class");if(S&&(r&&"P"==n&&r["p."+S]&&E(i,r["p."+S]),-1!=S.toLowerCase().indexOf("mso"))){var x=b(S);x=x.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""),x?i.setAttribute("class",x):i.removeAttribute("class")}if("A"==n&&!i.attributes.getNamedItem("href")&&i.innerHTML&&(i.outerHTML=i.innerHTML),"TD"!=n&&"TH"!=n||i.innerHTML||(i.innerHTML="<br>"),"TABLE"==n&&(t.node.clearAttributes(i),i.setAttribute("style","width: 100%;")),i.getAttribute("lang")&&i.removeAttribute("lang"),i.getAttribute("style")&&-1!=i.getAttribute("style").toLowerCase().indexOf("mso")){var M=b(i.getAttribute("style"));M=M.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""),M?i.setAttribute("style",M):i.removeAttribute("style")}return!0}function S(e){var t={},i=e.getElementsByTagName("style");if(i.length){var r=i[0],n=r.innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(n)for(var l=0;l<n.length;l++){var a=n[l],s=a.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),o=a.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");s=s.replace(/^[\s]|[\s]$/gm,""),o=o.replace(/^[\s]|[\s]$/gm,""),s=s.replace(/\n|\r|\n\r/g,""),o=o.replace(/\n|\r|\n\r/g,"");for(var d=s.split(", "),f=0;f<d.length;f++)t[d[f]]=o}}return t}function x(i,r){i=i.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/gi,"$1");var n=new DOMParser,l=n.parseFromString(i,"text/html"),a=l.head,d=l.body,u=S(a);o(d,function(t){if(t.nodeType==Node.TEXT_NODE&&/\n/.test(t.data)){if(!/\S/.test(t.data))return t.data==e.FE.UNICODE_NBSP||(s(t),!1);t.data=t.data.replace(/\n/gi," ")}return!0}),o(d,function(e){return e.nodeType==Node.ELEMENT_NODE&&"IMG"==e.tagName&&y(e,r),!0}),o(d,function(e){if(e.nodeType==Node.TEXT_NODE)return e.data=e.data.replace(/<br>(\n|\r)/gi,"<br>"),!1;if(e.nodeType==Node.ELEMENT_NODE){if(f(e)){var t=e.parentNode,i=e.previousSibling,r=c(e,u),n=null;return n=i?i.nextSibling:t.firstChild,n?t.insertBefore(r,n):t.appendChild(r),!1}return N(e,u)}return e.nodeType!=Node.COMMENT_NODE||(s(e),!1)}),o(d,function(e){if(e.nodeType==Node.ELEMENT_NODE){var t=e.tagName;if(!e.innerHTML&&-1==["BR","IMG"].indexOf(t)){for(var i=e.parentNode;i&&(s(e),e=i,!e.innerHTML);)i=e.parentNode;return!1}A(e)}return!0});var g=d.outerHTML,m=t.opts.htmlAllowedStyleProps;return t.opts.htmlAllowedStyleProps=t.opts.wordAllowedStyleProps,g=t.clean.html(g,t.opts.wordDeniedTags,t.opts.wordDeniedAttrs,!1),t.opts.htmlAllowedStyleProps=m,g}var M,H,w="word_paste";return{_init:i,clean:a}}});