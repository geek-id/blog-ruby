!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(i,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(i)),e(t)}:e(window.jQuery)}(function(e){if(e.extend(e.FE.DEFAULTS,{aviaryKey:"542e1ff5d5144b9b81cef846574ba6cf",aviaryScriptURL:"https://dme0ih8comzn4.cloudfront.net/imaging/v3/editor.js"}),e.FE.PLUGINS.imageAviary=function(i){function t(e,i){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.innerText="",t.onload=i,document.getElementsByTagName("head")[0].appendChild(t)}function n(){t(i.opts.aviaryScriptURL,a)}function a(){r=new Aviary.Feather({apiKey:i.opts.aviaryKey,displayImageSize:!0,theme:"minimum",onSave:function(t,n){var a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var t=document.createElement("CANVAS"),n=t.getContext("2d");t.height=this.height,t.width=this.width,n.drawImage(this,0,0);for(var a=t.toDataURL("image/png"),o=atob(a.split(",")[1]),d=[],m=0;m<o.length;m++)d.push(o.charCodeAt(m));var c=new Blob([new Uint8Array(d)],{type:"image/jpeg"});i.image.edit(e(u)),i.image.upload([c]),r.close()},a.src=n,r.showWaitIndicator()},onError:function(e){throw new Error(e.message)},onClose:function(){i.image.get()||i.image.edit(e(u))}})}function o(){u=i.image.get()[0],r.launch({image:u,url:u.src})}var r,u;return{_init:n,launch:o}},e.FE.DefineIcon("aviary",{NAME:"sliders"}),e.FE.RegisterCommand("aviary",{title:"Advanced Edit",undo:!1,focus:!1,callback:function(e,i){this.imageAviary.launch(i)},plugin:"imageAviary"}),!e.FE.PLUGINS.image)throw new Error("Image Aviary plugin requires image plugin.");e.FE.DEFAULTS.imageEditButtons.indexOf("imageStyle")>-1&&e.FE.DEFAULTS.imageEditButtons.splice(e.FE.DEFAULTS.imageEditButtons.indexOf("imageStyle"),1),e.FE.DEFAULTS.imageEditButtons.push("aviary")});